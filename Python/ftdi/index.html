<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-15">
    <title>FTDI GPIO selector</title>
    <script src="/js/jquery.min.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      $(document).ready(function () {
        $('select').change(function () {
          var $this = $(this);
          window.location = "?k=" + $this.attr("name") + '&v=' + $this.val();
        });
        $('input:button').click(function () {
          var $this = $(this);
          window.location = "?k=" + $this.attr("name") + '&v=true';
        });
      });
    </script>
    <style type="text/css">
    body {
      font-family: arial;
    }
    h1 {
      margin-left: 1em;
    }
    table {
      border: 1px solid grey;
      border-radius: 5px;
      margin: 2em auto;
    }
    tr {
      padding: 5px;
    }
    tr:nth-child(1) th {
      padding-bottom: 1.3em;
    }
    td {
      padding: 5px;
      text-align: center;
    }
    div#main {
      width: 40ex;
    }
    div#emergency {
      text-align: center;
    }
    span.error {
      margin-top: 2em;
      color: red;
      font-weight: bold;
      font-size: small;
    }
    input.button {
    }
    </style>
    <h1>Antenna selector</h1>
    <div id="main">
      <form id="update">
        <table>
          <tr>
            {% for antname in antennas %}
            <th>{{antennas[antname].band}} MHz</th>
            {% endfor %}
          <tr>
            {% for antname in antennas %}
            <td>
              <select name="{{antname}}">
                {% for ant in antennas[antname].ids %}
                {% set group = antennas[antname].group %}
                {% set main = ant // group + 1 %}
                {% set sub = ant % group + 1 %}
                {% set count = antennas[antname].count %}
                {% if (count > group) and (ant % group == 0)  %}
                  <optgroup label="Group {{main}}">
                {% endif %}
                    <option value="{{ant}}"{%
                      if antennas[antname].sel == ant
                        %}selected="selected"{%
                        endif %}>Antenna {{sub}}</option>
                 {% if (count > group) and (ant % group == 3)  %}
                  </optgroup>
                {% endif %}
                {%endfor %}
              </select>
            {% endfor %}
            </td>
          </tr>
          <tr>
            {% for antname in antennas %}
            <td>{% if not antennas[antname].status %}
              <span class="error">No FTDI device</span>
                {% endif %}</td>
            {% endfor %}
          </tr>
        </table>
       <div id="emergency">
          <div><input type="button" name="restart" value="restart"/></div>
        </div>
      </form>
    </div>
  </body>
</html>